"use strict";(self.webpackChunkfrontends=self.webpackChunkfrontends||[]).push([[188],{66188:(e,s,r)=>{r.r(s),r.d(s,{default:()=>W});var a=r(65043),o=r(7353),i=r(94496),l=r(11906),n=r(68903),t=r(79650),d=r(71806),c=r(84882),f=r(28076),u=r(10039),x=r(73460),h=r(94109),p=r(97654),m=r(39336),A=r(83462),j=r(4219),C=r(35316),F=r(29347),b=r(13892),g=r(85442),y=r(80899),_=r(70141),w=r(83560),B=r(33438),E=r(37141),k=r(51387),v=r(27415),I=r(70579);const S="https://willowtonbursary.co.za/api",T=y.Ik({first_name:y.Yj().required("First name is required"),last_name:y.Yj().required("Last name is required"),email_address:y.Yj().email("Invalid email address").required("Email is required"),password:y.Yj().min(6,"Password should be at least 6 characters").required("Password is required"),user_type:y.Yj().required("Please select user type")}),W=()=>{var e;const{isDarkMode:s}=(0,a.useContext)(v.D),[r,y]=(0,a.useState)([]),[W,M]=(0,a.useState)(!1),[P,L]=(0,a.useState)(null),[$,q]=(0,a.useState)(!1),D=(0,g.A)("(min-width:600px)")?500:330,z=null===(e=JSON.parse(localStorage.getItem("user")))||void 0===e?void 0:e.user_type;(0,a.useEffect)((()=>{(async()=>{let e="";if("admin"===z)e=`${S}/users`;else if("student"===z){var s;const r=null===(s=JSON.parse(localStorage.getItem("user")))||void 0===s?void 0:s.user_id;e=`${S}/users/${r}`}try{const s=await fetch(e),r=await s.json();"admin"===z?Array.isArray(r)?y(r):console.error("Fetched data is not an array"):"student"===z&&y([r])}catch(r){console.error("Error fetching users:",r)}})()}),[z]);const N=(0,b.Wx)({initialValues:{first_name:P?P.first_name:"",last_name:P?P.last_name:"",email_address:P?P.email_address:"",password:"",user_type:"admin"},validationSchema:T,enableReinitialize:!0,onSubmit:async e=>{const s=P?await fetch(`${S}/users/${P.user_id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}):await fetch(`${S}/users`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(s.ok){const e=await s.json();y((s=>P?s.map((s=>s.user_id===e.user_id?e:s)):[...s,e])),M(!1)}else console.error("Failed to save data")}}),U=e=>{(async e=>{const s=await fetch(`${S}/users/${e}`),r=await s.json();L(r)})(e.user_id),M(!0)},Y=()=>{q(!1)},O=()=>{M(!1)};return(0,I.jsxs)(o.A,{sx:{backgroundColor:s?"#2D3748":"#F7FAFC",minHeight:"100vh"},children:[(0,I.jsxs)(o.A,{sx:{border:"1px solid #ccc",padding:"12px",backgroundColor:s?"#1E293B":"#e1f5fe",borderRadius:"8px",marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,I.jsx)(i.A,{variant:"h6",sx:{fontWeight:"bold",color:s?"#F7FAFC":"#1E293B"},children:"User Information"}),"admin"===z&&(0,I.jsxs)(l.A,{variant:"contained",color:"primary",onClick:()=>{L(null),M(!0)},fontSize:"small",sx:{display:"flex",alignItems:"center",backgroundColor:s?"white":"black",color:s?"black":"white",padding:"2px 6px",textTransform:"none"},children:[(0,I.jsx)(_.A,{sx:{marginRight:1,fontSize:15}}),"Create"]})]}),(0,I.jsx)(n.Ay,{container:!0,spacing:3,children:(0,I.jsx)(n.Ay,{item:!0,xs:12,children:(0,I.jsx)(t.A,{sx:{width:"100%"},children:(0,I.jsxs)(d.A,{sx:{backgroundColor:s?"#1A202C":"#ffffff",borderRadius:"8px"},children:[(0,I.jsx)(c.A,{children:(0,I.jsxs)(f.A,{children:[(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B",fontWeight:"bold"}}),(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B",fontWeight:"bold"},children:"First Name"}),(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B",fontWeight:"bold"},children:"Last Name"}),(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B",fontWeight:"bold"},children:"Email Address"}),(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B",fontWeight:"bold"},children:"User Type"})]})}),(0,I.jsx)(x.A,{children:Array.isArray(r)&&r.map((e=>(0,I.jsxs)(f.A,{children:[(0,I.jsx)(u.A,{sx:{padding:"5px"},children:(0,I.jsx)(l.A,{onClick:()=>U(e),fontsize:"small",sx:{cursor:"pointer"},children:(0,I.jsx)(w.A,{})})}),(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B"},children:e.first_name}),(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B"},children:e.last_name}),(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B"},children:e.email_address}),(0,I.jsx)(u.A,{sx:{padding:"10px",color:s?"#F7FAFC":"#1E293B"},children:e.user_type})]},e.user_id)))})]})})})}),(0,I.jsx)(h.Ay,{anchor:"right",open:W,onClose:O,children:(0,I.jsxs)(o.A,{sx:{width:D,height:"100%",display:"flex",flexDirection:"column",backgroundColor:s?"#2D3748":"#ffffff"},children:[(0,I.jsx)(o.A,{sx:{p:2,borderBottom:"1px solid #ccc"},children:(0,I.jsx)(i.A,{variant:"h6",sx:{color:s?"#F7FAFC":"#1E293B"},children:P?"Edit User":"Create User"})}),(0,I.jsx)(o.A,{sx:{flex:1,overflowY:"auto",p:2},children:(0,I.jsx)("form",{onSubmit:N.handleSubmit,children:(0,I.jsxs)(n.Ay,{container:!0,spacing:2,children:[(0,I.jsx)(n.Ay,{item:!0,xs:12,children:(0,I.jsx)(p.A,{label:"First Name",fullWidth:!0,name:"first_name",value:N.values.first_name,onChange:N.handleChange,error:N.touched.first_name&&Boolean(N.errors.first_name),helperText:N.touched.first_name&&N.errors.first_name,sx:{backgroundColor:s?"#1A202C":"#ffffff",color:s?"#F7FAFC":"#1E293B","& .MuiInputBase-input":{color:s?"white":"#1e293b"}},InputLabelProps:{style:{color:s?"#ffffff":"#000000"}}})}),(0,I.jsx)(n.Ay,{item:!0,xs:12,children:(0,I.jsx)(p.A,{label:"Last Name",fullWidth:!0,name:"last_name",value:N.values.last_name,onChange:N.handleChange,error:N.touched.last_name&&Boolean(N.errors.last_name),helperText:N.touched.last_name&&N.errors.last_name,sx:{backgroundColor:s?"#1A202C":"#ffffff",color:s?"#F7FAFC":"#1E293B","& .MuiInputBase-input":{color:s?"white":"#1e293b"}},InputLabelProps:{style:{color:s?"#ffffff":"#000000"}}})}),(0,I.jsx)(n.Ay,{item:!0,xs:12,children:(0,I.jsx)(p.A,{label:"Email Address",fullWidth:!0,name:"email_address",value:N.values.email_address,onChange:N.handleChange,error:N.touched.email_address&&Boolean(N.errors.email_address),helperText:N.touched.email_address&&N.errors.email_address,sx:{backgroundColor:s?"#1A202C":"#ffffff",color:s?"#F7FAFC":"#1E293B","& .MuiInputBase-input":{color:s?"white":"#1e293b"}},InputLabelProps:{style:{color:s?"#ffffff":"#000000"}}})}),(0,I.jsx)(n.Ay,{item:!0,xs:12,children:(0,I.jsx)(p.A,{label:"Password",fullWidth:!0,name:"password",type:"password",value:N.values.password,onChange:N.handleChange,error:N.touched.password&&Boolean(N.errors.password),helperText:N.touched.password&&N.errors.password,sx:{backgroundColor:s?"#1A202C":"#ffffff",color:s?"#F7FAFC":"#1E293B","& .MuiInputBase-input":{color:s?"white":"#1e293b"}},InputLabelProps:{style:{color:s?"#ffffff":"#000000"}}})}),(0,I.jsx)(n.Ay,{item:!0,xs:12,children:(0,I.jsx)(p.A,{label:"User Type",value:P?P.user_type:"admin",disabled:!0,fullWidth:!0,sx:{backgroundColor:s?"#1A202C":"#ffffff",color:s?"white":"#1E293B",marginTop:2,"& .MuiInputBase-input":{color:s?"white":"#1E293B"},"& .MuiInputLabel-root":{color:s?"#ffffff":"#000000"},"& .MuiInputBase-root.Mui-disabled":{backgroundColor:s?"#1A202C":"#ffffff"},"& .MuiInputBase-input.Mui-disabled":{WebkitTextFillColor:s?"white":"#1E293B"}},InputLabelProps:{style:{color:s?"#ffffff":"#000000"}}})})]})})}),(0,I.jsx)(m.A,{}),(0,I.jsxs)(o.A,{sx:{p:2,display:"flex",justifyContent:"space-between",marginTop:"auto"},children:[(0,I.jsxs)(o.A,{sx:{display:"flex",gap:1},children:[(0,I.jsx)(l.A,{onClick:O,startIcon:(0,I.jsx)(B.A,{}),size:"small",variant:"outlined",sx:{borderColor:s?"#F7FAFC":"#1E293B"},children:"Close"}),P&&"student"!==z&&(0,I.jsx)(l.A,{onClick:()=>{q(!0)},startIcon:(0,I.jsx)(k.A,{}),size:"small",color:"error",variant:"outlined",sx:{borderColor:s?"#F7FAFC":"#1E293B"},children:"Delete"})]}),(0,I.jsx)(l.A,{onClick:N.handleSubmit,startIcon:P?(0,I.jsx)(E.A,{}):(0,I.jsx)(_.A,{}),variant:"contained",size:"small",children:P?"Save":"Create"})]})]})}),(0,I.jsxs)(A.A,{open:$,onClose:Y,children:[(0,I.jsx)(j.A,{children:"Confirm Deletion"}),(0,I.jsx)(C.A,{children:"Are you sure you want to delete this user?"}),(0,I.jsxs)(F.A,{children:[(0,I.jsx)(l.A,{onClick:Y,color:"primary",children:"Cancel"}),(0,I.jsx)(l.A,{onClick:async()=>{if(P)try{await fetch(`${S}/users/${P.user_id}`,{method:"DELETE"}),y((e=>e.filter((e=>e.user_id!==P.user_id)))),q(!1),M(!1)}catch(e){console.error("Failed to delete user",e)}},color:"error",children:"Delete"})]})]})]})}}}]);
//# sourceMappingURL=188.212889b7.chunk.js.map