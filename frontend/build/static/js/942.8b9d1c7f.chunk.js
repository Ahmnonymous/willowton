"use strict";(self.webpackChunkfrontends=self.webpackChunkfrontends||[]).push([[942],{24942:(e,t,s)=>{s.r(t),s.d(t,{default:()=>_});var n=s(65043),l=s(7353),r=s(77739),i=s(17392),o=s(62559),a=s(70378),c=s(32143),d=s(74605),x=s(23217),h=s(39336),u=s(2050),m=s(48734),p=s(94496),f=s(11906),j=s(72221),A=s(79484),g=s(52879),b=s(47968),k=s(47805),C=s(15954),S=s(68843),y=s(37131),w=s(99389),v=s(30079),z=s(86213),E=s(11238),L=s(27415),D=s(36248),I=(s(84713),s(70579));const _=function(){const{isDarkMode:e}=(0,n.useContext)(L.D),[t,s]=(0,n.useState)([]),[_,R]=(0,n.useState)(""),[N,W]=(0,n.useState)([]),[F,M]=(0,n.useState)([]),[P,B]=(0,n.useState)(null),[O,H]=(0,n.useState)(!1),[T,U]=(0,n.useState)({key:null,direction:null}),[V,q]=(0,n.useState)(0),[G,J]=(0,n.useState)(10),[K,Q]=(0,n.useState)(""),[X,Y]=(0,n.useState)(0),Z=(0,n.useRef)(null),$=Boolean(P),ee=(0,n.useCallback)((async()=>{try{var e,t;const n=await z.A.get("https://willowtonbursary.co.za/api/student-details"),l=Array.isArray(n.data)?n.data:null!==(e=null===n||void 0===n||null===(t=n.data)||void 0===t?void 0:t.records)&&void 0!==e?e:[];if(l.length>0){const e=Object.keys(l[0]).filter((e=>"id"!==e));W(e),M(e)}s(l)}catch(n){console.error("Failed to fetch students:",n),s([])}}),[]);(0,n.useEffect)((()=>{ee()}),[ee]),(0,n.useEffect)((()=>{const e=e=>{Z.current&&!Z.current.contains(e.target)&&H(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const te=e=>e.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase())),se=t.filter((e=>F.some((t=>{const s=e[t];return null!=s&&s.toString().toLowerCase().includes(_.toLowerCase())})))).sort(((e,t)=>{if(!T.key||!T.direction)return 0;const s=e[T.key],n=t[T.key];return null==s||null==n?0:"asc"===T.direction?s.toString().localeCompare(n.toString()):n.toString().localeCompare(s.toString())})),ne=se.slice(V*G,(V+1)*G);(0,n.useEffect)((()=>{Y(se.length)}),[se]);const le=N.filter((e=>e.toLowerCase().includes(K.toLowerCase())||te(e).toLowerCase().includes(K.toLowerCase())));return(0,I.jsxs)(l.A,{sx:{backgroundColor:e?"#2D3748":"#F7FAFC",minHeight:"100vh",p:2},children:[(0,I.jsx)(D.A,{title:"Student Report"}),(0,I.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1,mb:2},children:[!O&&(0,I.jsx)(r.A,{title:"Search",children:(0,I.jsx)(i.A,{size:"small",onClick:()=>H(!0),sx:{color:e?"white":"black"},children:(0,I.jsx)(A.A,{fontSize:"small"})})}),(0,I.jsx)(l.A,{ref:Z,sx:{width:O?220:0,height:36,transition:"width 0.3s ease",overflow:"hidden"},children:O&&(0,I.jsx)(o.Ay,{placeholder:"Search",value:_,onChange:e=>{R(e.target.value),q(0)},sx:{backgroundColor:e?"#1e293b":"#fff",color:e?"white":"black",px:1.5,height:"100%",fontSize:"0.85rem",borderRadius:1,border:"1px solid "+(e?"#4A5568":"#CBD5E0"),width:"100%"},startAdornment:(0,I.jsx)(A.A,{sx:{mr:1},fontSize:"small"})})}),(0,I.jsx)(r.A,{title:"Column Visibility",children:(0,I.jsx)(i.A,{size:"small",onClick:e=>B(e.currentTarget),sx:{color:e?"white":"black"},children:(0,I.jsx)(g.A,{fontSize:"small"})})}),(0,I.jsx)(r.A,{title:"Export to Excel",children:(0,I.jsx)(i.A,{size:"small",onClick:()=>{const e=t.map((e=>Object.fromEntries(F.map((t=>[te(t),e[t]]))))),s=E.Wp.json_to_sheet(e),n=E.Wp.book_new();E.Wp.book_append_sheet(n,s,"Report"),E._h(n,"student_report.xlsx")},sx:{color:e?"white":"black"},children:(0,I.jsx)(b.A,{fontSize:"small"})})})]}),(0,I.jsxs)(a.A,{anchorEl:P,open:$,onClose:()=>B(null),PaperProps:{sx:{minWidth:200,maxHeight:300,p:1}},children:[(0,I.jsx)(o.Ay,{placeholder:"Search Columns",value:K,onChange:e=>Q(e.target.value),sx:{mb:1,px:1,fontSize:"0.7rem",backgroundColor:"#f1f5f9",borderRadius:1,width:"100%",height:"28px"}}),le.map((e=>(0,I.jsx)(c.A,{dense:!0,children:(0,I.jsx)(d.A,{control:(0,I.jsx)(x.A,{size:"small",checked:F.includes(e),onChange:()=>(e=>{if(F.includes(e))M((t=>t.filter((t=>t!==e))));else{const t=N.indexOf(e),s=[...F];s.splice(t,0,e),M(s)}})(e)}),label:(0,I.jsx)("span",{style:{fontSize:"0.7rem"},children:te(e)})})},e))),(0,I.jsx)(h.A,{sx:{my:1}}),(0,I.jsxs)(c.A,{dense:!0,onClick:()=>{M(N),B(null)},children:[(0,I.jsx)(u.A,{children:(0,I.jsx)(k.A,{fontSize:"small"})}),(0,I.jsx)(m.A,{primary:"Reset Columns",primaryTypographyProps:{fontSize:"0.7rem"}})]})]}),(0,I.jsx)("div",{className:"generic-table-container",children:(0,I.jsxs)("table",{className:"generic-table",style:{backgroundColor:e?"#1e293b":"#fff"},children:[(0,I.jsx)("thead",{children:(0,I.jsx)("tr",{children:F.map((t=>(0,I.jsx)("th",{style:{color:e?"white":"#1e293b",cursor:"pointer",position:"relative"},onClick:()=>(e=>{U((t=>t.key===e?{key:e,direction:"asc"===t.direction?"desc":"desc"===t.direction?null:"asc"}:{key:e,direction:"asc"})),q(0)})(t),children:(0,I.jsxs)(l.A,{sx:{display:"flex",alignItems:"center"},children:[te(t),(0,I.jsxs)(l.A,{sx:{ml:.5,display:"flex",alignItems:"center"},children:[T.key===t&&"asc"===T.direction&&(0,I.jsx)(S.A,{fontSize:"small"}),T.key===t&&"desc"===T.direction&&(0,I.jsx)(C.A,{fontSize:"small"}),T.key===t&&null===T.direction&&(0,I.jsx)(v.A,{fontSize:"small"})]})]})},t)))})}),(0,I.jsx)("tbody",{children:ne.length>0?ne.map((t=>(0,I.jsx)("tr",{children:F.map((s=>{return(0,I.jsx)("td",{style:{color:e?"white":"#1e293b"},children:s.includes("date")?(n=t[s],n?new Date(n).toLocaleDateString():"N/A"):t[s]},s);var n}))},t.id))):(0,I.jsx)("tr",{children:(0,I.jsx)("td",{colSpan:F.length,className:"no-matching-records",children:"No matching records found"})})})]})}),(0,I.jsxs)(l.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2},children:[(0,I.jsxs)(p.A,{variant:"caption",children:[V*G+1,"-",Math.min((V+1)*G,X)," of ",X]}),(0,I.jsxs)(l.A,{sx:{display:"flex",alignItems:"center",gap:1},children:[(0,I.jsx)(f.A,{onClick:()=>q((e=>Math.max(0,e-1))),disabled:0===V,size:"small",variant:"outlined",startIcon:(0,I.jsx)(y.A,{fontSize:"small"}),children:"Prev"}),(0,I.jsx)(j.A,{value:G,onChange:e=>{J(parseInt(e.target.value)),q(0)},size:"small",sx:{fontSize:"0.85rem"},children:[5,10,20,50].map((e=>(0,I.jsx)(c.A,{value:e,children:e},e)))}),(0,I.jsx)(f.A,{onClick:()=>q((e=>(e+1)*G<X?e+1:e)),disabled:(V+1)*G>=X,size:"small",variant:"outlined",endIcon:(0,I.jsx)(w.A,{fontSize:"small"}),children:"Next"})]})]})]})}},36248:(e,t,s)=>{s.d(t,{A:()=>a});var n=s(65043),l=s(7353),r=s(94496),i=s(27415),o=s(70579);const a=e=>{let{title:t}=e;const{isDarkMode:s}=(0,n.useContext)(i.D);return(0,o.jsx)(l.A,{sx:{padding:"12px",backgroundColor:s?"#1e293b":"#e1f5fe",borderRadius:"8px",marginBottom:"12px",border:"1px solid #ccc"},children:(0,o.jsx)(r.A,{variant:"h6",sx:{color:s?"white":"black",fontWeight:"bold"},children:t})})}},84713:()=>{}}]);
//# sourceMappingURL=942.8b9d1c7f.chunk.js.map